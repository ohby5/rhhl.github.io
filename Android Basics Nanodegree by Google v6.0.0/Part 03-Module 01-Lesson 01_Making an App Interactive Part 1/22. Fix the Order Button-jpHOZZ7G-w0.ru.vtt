WEBVTT
Kind: captions
Language: ru

00:00:00.240 --> 00:00:02.680
Нет одного правильного ответа
на этот вопрос.

00:00:02.680 --> 00:00:06.150
Все зависит от того, что для вас
эффективнее в определении

00:00:06.150 --> 00:00:10.180
разницы между корректной и
некорректной работой приложения.

00:00:10.420 --> 00:00:12.640
Вот что я заметила.

00:00:12.640 --> 00:00:15.990
Когда приложение работает некорректно,
при нажатии на кнопку <i>Order</i>

00:00:15.990 --> 00:00:19.990
количество каждый раз изменяется
на одну и ту же величину, хотя не должно.

00:00:19.990 --> 00:00:23.060
Кроме того, я вижу, что
цена была верной для этого количества,

00:00:23.060 --> 00:00:25.010
но на самом деле
цена должна быть указана

00:00:25.010 --> 00:00:28.310
для последнего числа,
выбранного вот здесь.

00:00:28.310 --> 00:00:31.570
Это опять-таки связано с тем, что
количество не должно меняться.

00:00:31.570 --> 00:00:34.230
Давайте посмотрим на код и разберемся,
почему так происходит.

00:00:35.390 --> 00:00:39.320
В файле <i>activity_main</i>
кнопка <i>Order</i> объявлена вот здесь.

00:00:39.320 --> 00:00:40.696
При нажатии на кнопку <i>Order</i>

00:00:40.696 --> 00:00:43.102
вызывается метод
под названием <i>submitOrder</i>.

00:00:43.102 --> 00:00:47.890
В файле <i>MainActivity.java</i>
метод <i>submitOrder</i> находится здесь.

00:00:47.890 --> 00:00:51.030
Это очень старый кусок кода,
который мы еще не поменяли.

00:00:51.030 --> 00:00:54.570
Здесь мы объявляем целую переменную
<i>quantity</i> с начальным значением 5

00:00:54.570 --> 00:00:56.300
и выводим ее на экран.

00:00:56.300 --> 00:01:00.610
Мы также показываем стоимость, которая
равна числу чашек кофе, умноженному на $5.

00:01:00.610 --> 00:01:03.700
Этот код уже не очень логичный,
поскольку при заказе

00:01:03.700 --> 00:01:06.530
мы пытаемся обновить количество.

00:01:06.530 --> 00:01:09.411
Еще одна проблема - это объявление
целой переменной <i>quantity</i>,

00:01:09.411 --> 00:01:12.238
когда у нас уже есть глобальная
переменная <i>quantity</i>,

00:01:12.238 --> 00:01:13.747
отслеживающая число чашек кофе.

00:01:13.747 --> 00:01:18.026
В файле <i>MainActivity</i> у нас уже есть
глобальная переменная <i>quantity</i>,

00:01:18.026 --> 00:01:22.520
поэтому любой метод внутри этого кода
может обращаться к этой переменной.

00:01:22.520 --> 00:01:27.060
Однако в методе <i>submitOrder</i> мы объявляем
новую локальную переменную <i>quantity</i>.

00:01:27.060 --> 00:01:30.410
Формально у локальной переменной
может быть такое же имя,

00:01:30.410 --> 00:01:32.200
как и у глобальной переменной.

00:01:32.200 --> 00:01:34.812
Просто в рамках этого метода

00:01:34.812 --> 00:01:38.581
после объявления этой переменной
каждый раз при обращении к <i>quantity</i>

00:01:38.581 --> 00:01:41.985
вызываться будет
локальная переменная со значением 5,

00:01:41.985 --> 00:01:44.396
а не глобальная переменная
со значением 2.

00:01:44.396 --> 00:01:46.310
Так что и <i>display(quantity)</i>,

00:01:46.310 --> 00:01:51.500
и <i>displayPrice(quantityx5)</i>
обращаются к этому значению <i>quantity</i>.

00:01:51.500 --> 00:01:54.080
Вот область видимости
этой локальной переменной.

00:01:54.080 --> 00:01:55.490
За пределами этой области,

00:01:55.490 --> 00:01:59.490
когда вы обращаетесь к <i>quantity</i>,
вы вызываете глобальную переменную.

00:01:59.490 --> 00:02:00.330
Если подумать,

00:02:00.330 --> 00:02:03.430
это совсем нелогично, что при заказе

00:02:03.430 --> 00:02:07.040
создается новая переменная <i>quantity</i>,
которая и выводится на экран.

00:02:07.040 --> 00:02:10.070
На самом деле нужно использовать
переменную <i>quantity</i>,

00:02:10.070 --> 00:02:14.900
которая отслеживает увеличение или
уменьшение числа чашек кофе.

00:02:14.900 --> 00:02:18.040
И общую стоимость
нужно рассчитывать, исходя из нее.

00:02:18.040 --> 00:02:22.070
Чтобы исправить код, нам нужно убрать
объявление локальной переменной <i>quantity</i>.

00:02:22.070 --> 00:02:25.130
Вместо нее нужно использовать
глобальную переменную <i>quantity</i>.

00:02:25.130 --> 00:02:28.550
Также мы не должны
обновлять количество на экране.

00:02:28.550 --> 00:02:31.270
Кнопки "плюс" и "минус"
уже отвечают за отображение

00:02:31.270 --> 00:02:33.520
на экране корректного числа.

00:02:33.520 --> 00:02:37.570
Кнопка <i>submitOrder</i> должна
по-прежнему обновлять стоимость.

00:02:37.570 --> 00:02:41.600
Но в этот раз мы рассчитаем
стоимость как (quantity * 5),

00:02:41.600 --> 00:02:43.990
используя глобальную переменную.

00:02:43.990 --> 00:02:47.720
Я исправлю код в соответствии
с этими замечаниями.

00:02:47.720 --> 00:02:50.860
Обратите внимание, что переменная <i>quantity</i>
теперь выделена фиолетовым цветом.

00:02:50.860 --> 00:02:54.030
Это значит, что мы используем глобальную
переменную <i>quantity</i> файла <i>MainActivity</i>.

00:02:54.030 --> 00:02:57.940
Нажатие кнопки
вызывает метод <i>submitOrder</i>,

00:02:57.940 --> 00:02:59.580
который выводит на экран стоимость,

00:02:59.580 --> 00:03:03.934
из расчета: глобальная
переменная <i>quantity</i>, умноженная на 5.

00:03:04.970 --> 00:03:06.670
Похоже, все верно.
Давайте проверим.

00:03:07.680 --> 00:03:09.530
Итак, решающий тест.

00:03:09.530 --> 00:03:12.660
Я меняю количество на 6
и нажимаю на кнопку <i>Order</i>.

00:03:13.660 --> 00:03:14.510
Ура! Получилось $30.

00:03:14.510 --> 00:03:17.630
Я попробую и другие значения,
чтобы убедиться наверняка.

00:03:17.630 --> 00:03:18.958
Все правильно.

00:03:18.958 --> 00:03:22.600
И это правильно.
Отлично! Все работает.

00:03:22.600 --> 00:03:24.310
Вы исправили свой первый баг.

00:03:24.310 --> 00:03:26.400
Вы хорошо поработали
над этим заданием.

00:03:26.400 --> 00:03:28.970
Функции приложения
в полном порядке.

00:03:28.970 --> 00:03:32.280
Но мне кажется,
интерфейс у него тоскливый.

00:03:32.280 --> 00:03:35.800
Особенно выбор количества
стоит сделать посимпатичней.

00:03:35.800 --> 00:03:36.740
Этим и займемся.

