<!-- udacity2.0 -->
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Quiz: Display date and time of earthquake</title>
  <link rel="stylesheet" href="../assets/css/bootstrap.min.css">
  <link rel="stylesheet" href="../assets/css/plyr.css">
  <link rel="stylesheet" href="../assets/css/katex.min.css">
  <link rel="stylesheet" href="../assets/css/jquery.mCustomScrollbar.min.css">
  <link rel="stylesheet" href="../assets/css/styles.css">
  <link rel="shortcut icon" type="image/png" href="../assets/img/udacimak.png" />
</head>

<body>
  <div class="wrapper">
    <nav id="sidebar">
  <div class="sidebar-header">
    <h3>JSON Parsing</h3>
  </div>

  <ul class="sidebar-list list-unstyled CTAs">
    <li>
      <a href="../index.html" class="article">Back to Home</a>
    </li>
  </ul>

  <ul class="sidebar-list list-unstyled components">
    <li class="">
      <a href="01. Earthquake at the Coffee Shop.html">01. Earthquake at the Coffee Shop</a>
    </li>
    <li class="">
      <a href="02. Where to Find Earthquake Data .html">02. Where to Find Earthquake Data? </a>
    </li>
    <li class="">
      <a href="03. Receiving Mocks from Our Designer.html">03. Receiving Mocks from Our Designer</a>
    </li>
    <li class="">
      <a href="04. Course Map.html">04. Course Map</a>
    </li>
    <li class="">
      <a href="05. Explore USGS Website As A User.html">05. Explore USGS Website As A User</a>
    </li>
    <li class="">
      <a href="06. Drive-Through Data.html">06. Drive-Through Data</a>
    </li>
    <li class="">
      <a href="07. Explore USGS Website As A Developer.html">07. Explore USGS Website As A Developer</a>
    </li>
    <li class="">
      <a href="08. Import Existing Project.html">08. Import Existing Project</a>
    </li>
    <li class="">
      <a href="09. Checking the build.gradle file.html">09. Checking the build.gradle file</a>
    </li>
    <li class="">
      <a href="10. Solution Code on GitHub.html">10. Solution Code on GitHub</a>
    </li>
    <li class="">
      <a href="11. Show more info on each earthquake.html">11. Show more info on each earthquake</a>
    </li>
    <li class="">
      <a href="12. Overview of JSON.html">12. Overview of JSON</a>
    </li>
    <li class="">
      <a href="13. JSON Components.html">13. JSON Components</a>
    </li>
    <li class="">
      <a href="14. Traverse Nodes in JSON Object Tree.html">14. Traverse Nodes in JSON Object Tree</a>
    </li>
    <li class="">
      <a href="15. Parsing JSON in Android.html">15. Parsing JSON in Android</a>
    </li>
    <li class="">
      <a href="16. Look at Earthquake Query Result.html">16. Look at Earthquake Query Result</a>
    </li>
    <li class="">
      <a href="17. Traversing Earthquake JSON Object Tree.html">17. Traversing Earthquake JSON Object Tree</a>
    </li>
    <li class="">
      <a href="18. Parse JSON response in Quake Report app.html">18. Parse JSON response in Quake Report app</a>
    </li>
    <li class="">
      <a href="19. Display date and time of earthquake.html">19. Display date and time of earthquake</a>
    </li>
    <li class="">
      <a href="20. Quiz Display date and time of earthquake.html">20. Quiz: Display date and time of earthquake</a>
    </li>
    <li class="">
      <a href="21. Split location into 2 TextViews.html">21. Split location into 2 TextViews</a>
    </li>
    <li class="">
      <a href="22. Magnitude as a Decimal Value.html">22. Magnitude as a Decimal Value</a>
    </li>
    <li class="">
      <a href="23. Switch Statement.html">23. Switch Statement</a>
    </li>
    <li class="">
      <a href="24. Circle Background for Magnitude.html">24. Circle Background for Magnitude</a>
    </li>
    <li class="">
      <a href="25. Visual Polish.html">25. Visual Polish</a>
    </li>
    <li class="">
      <a href="26. Add Earthquake Intent.html">26. Add Earthquake Intent</a>
    </li>
    <li class="">
      <a href="27. Reflection.html">27. Reflection</a>
    </li>
  </ul>

  <ul class="sidebar-list list-unstyled CTAs">
    <li>
      <a href="../index.html" class="article">Back to Home</a>
    </li>
  </ul>
</nav>

    <div id="content">
      <header class="container-fluild header">
        <div class="container">
          <div class="row">
            <div class="col-12">
              <div class="align-items-middle">
                <button type="button" id="sidebarCollapse" class="btn btn-toggle-sidebar">
                  <div></div>
                  <div></div>
                  <div></div>
                </button>

                <h1 style="display: inline-block">20. Quiz: Display date and time of earthquake</h1>
              </div>
            </div>
          </div>
        </div>
      </header>

      <main class="container">
        <div class="row">
          <div class="col-12">
            <div class="ud-atom">
  <h3><p>Quiz: Display date and time of earthquake</p></h3>
  <div>
  <h2 id="your-turn">Your Turn</h2>
<p>Since the SimpleDateFormat.format() method requires a <a href="https://developer.android.com/reference/java/util/Date.html" target="_blank">Date object</a>, which in turn requires a long as input, we should extract the time of the earthquake from the JSON response as a long data type (instead of a String). Long is one of the 8 primitive data types in Java <a href="https://docs.oracle.com/javase/tutorial/java/nutsandbolts/datatypes.html" target="_blank">here</a>. </p>
<p>Modify the QueryUtils.extractEarthquakes() method to extract the time of the earthquake as a “long” data type from the JSON response.</p>
<p>// Extract the value for the key called "time"<br />
long time = properties.getLong("time");</p>
<p>This causes a ripple effect and we need to update other places in the app as well.</p>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3><p>Quiz: Display date and time of earthquake</p></h3>
  <div>
  <form>
    <fieldset>
      <legend><p>Store time (in milliseconds) of each earthquake as a long data type, create a <a href="https://developer.android.com/reference/java/util/Date.html">Date</a> object, and Format date and time into a readable string for the user, in EarthquakeAdapter class:</p></legend>
    </fieldset>

    <div>
      <input type="checkbox" value="a1468957550428" name="160869" id="a1468957550428">
      <label for="a1468957550428"><p>In QueryUtils class, extract time as a long when parsing the JSON response</p></label>
    </div>
    <div>
      <input type="checkbox" value="a1468957601782" name="160869" id="a1468957601782">
      <label for="a1468957601782"><p>In Earthquake class, store time as a long</p></label>
    </div>
    <div>
      <input type="checkbox" value="a1468957608941" name="160869" id="a1468957608941">
      <label for="a1468957608941"><p>Create Date object from time in milliseconds</p></label>
    </div>
    <div>
      <input type="checkbox" value="a1468957617483" name="160869" id="a1468957617483">
      <label for="a1468957617483"><p>Use SimpleDateFormat to format the date and time into readable Strings</p></label>
    </div>
    <div>
      <input type="checkbox" value="a1468957618913" name="160869" id="a1468957618913">
      <label for="a1468957618913"><p>Update list item layout to show date and time in 2 separate TextViews</p></label>
    </div>
  </form>

  <details>
    <summary><strong>SOLUTION:</strong></summary>
    <ul>
      <li> In QueryUtils class, extract time as a long when parsing the JSON response</li>
      <li> In Earthquake class, store time as a long</li>
      <li> Create Date object from time in milliseconds</li>
      <li>Use SimpleDateFormat to format the date and time into readable Strings</li>
      <li>Update list item layout to show date and time in 2 separate TextViews</li>
  </ul>
  </details>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3><p>Solution: </p></h3>
  <div>
  <p>First, let’s modify the QueryUtils extractEarthquakes() method to extract time as a long data type from the JSON response.</p>
<p>In the QueryUtils extractEarthquakes() method:</p>
<pre><code> // Extract the value for the key called "time"
 long time = properties.getLong("time");</code></pre>
<p>This will cause an error because the Earthquake constructor doesn’t accept a long data type as the third input parameter. Hence, we need to make some changes to the Earthquake class.</p>
<p>Change the data type of the global variable, and rename it so the name is more descriptive of the information stored inside.</p>
<p><em>In Earthquake.java:</em></p>
<pre><code>  /** Time of the earthquake */
  private long mTimeInMilliseconds;</code></pre>
<p>Modify the Earthquake constructor so that it takes a long data type for the time and update the Javadoc comments.</p>
<p><em>In Earthquake.java:</em></p>
<pre><code>  /**
   * Constructs a new {@link Earthquake} object.
   *
   * @param magnitude is the magnitude (size) of the earthquake 
   * @param location is the city location of the earthquake
   * @param timeInMilliseconds is the time in milliseconds (from the Epoch) when the
   *  earthquake happened
   */
  public Earthquake(String magnitude, String location, long timeInMilliseconds) {
        mMagnitude = magnitude;
        mLocation = location;
        mTimeInMilliseconds = timeInMilliseconds;
  }</code></pre>
<p>Update the public getter method so that a long data type is returned.</p>
<p><em>In Earthquake.java:</em></p>
<pre><code>  /**
  * Returns the time of the earthquake.
  */
  public long getTimeInMilliseconds() {
     return mTimeInMilliseconds;
  }</code></pre>
<p>When the EarthquakeAdapter creates list items for each earthquake, the adapter must convert the time in milliseconds into a properly formatted date and time. There are now 2 TextViews that display date and time separately, so we need to modify the earthquake_list_item.xml layout to add another TextView and give it an appropriate view ID.</p>
<p><em>In earthquake_list_item.xml:</em></p>
<pre><code>  &lt;LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
      xmlns:tools="http://schemas.android.com/tools"
      android:layout_width="match_parent"
      android:layout_height="match_parent"
      android:orientation="horizontal"
      android:padding="16dp"&gt;

      &lt;TextView
          android:id="@+id/magnitude"
          android:layout_width="0dp"
          android:layout_height="wrap_content"
          android:layout_weight="1"
          tools:text="8.9" /&gt;

      &lt;TextView
          android:id="@+id/location"
          android:layout_width="0dp"
          android:layout_height="wrap_content"
          android:layout_weight="1"
          tools:text="San Francisco, CA" /&gt;

      &lt;TextView
          android:id="@+id/date"
          android:layout_width="0dp"
          android:layout_height="wrap_content"
          android:layout_weight="1"
          tools:text="Mar 6, 2010" /&gt;

      &lt;TextView
          android:id="@+id/time"
          android:layout_width="0dp"
          android:layout_height="wrap_content"
          android:layout_weight="1"
          tools:text="3:00 PM" /&gt;

  &lt;/LinearLayout&gt;</code></pre>
<p>Within the EarthquakeAdapter, we modify the getView() method to produce the formatted strings to display in the corresponding TextViews. We get the time from the current Earthquake object, using currentEarthquake.getTimeInMilliseconds(), and pass that into the Date constructor to form a new Date object. </p>
<p><em>In EarthquakeAdapter.java:</em></p>
<pre><code>  public View getView(int position, View convertView, ViewGroup parent) {
  // Check if there is an existing list item view (called convertView) that we can reuse,
  // otherwise, if convertView is null, then inflate a new list item layout.
          View listItemView = convertView;
          if (listItemView == null) {
              listItemView = LayoutInflater.from(getContext()).inflate(
                      R.layout.earthquake_list_item, parent, false);
          }

          // Find the earthquake at the given position in the list of earthquakes
          Earthquake currentEarthquake = getItem(position);

          // Find the TextView with view ID magnitude
          TextView magnitudeView = (TextView) listItemView.findViewById(R.id.magnitude);
          // Display the magnitude of the current earthquake in that TextView
          magnitudeView.setText(currentEarthquake.getMagnitude());

          // Find the TextView with view ID location
          TextView locationView = (TextView) listItemView.findViewById(R.id.location);
          // Display the location of the current earthquake in that TextView
          locationView.setText(currentEarthquake.getLocation());

          // Create a new Date object from the time in milliseconds of the earthquake
          Date dateObject = new Date(currentEarthquake.getTimeInMilliseconds());

          // Find the TextView with view ID date
          TextView dateView = (TextView) listItemView.findViewById(R.id.date);
          // Format the date string (i.e. "Mar 3, 1984")
          String formattedDate = formatDate(dateObject);
          // Display the date of the current earthquake in that TextView
          dateView.setText(formattedDate);

          // Find the TextView with view ID time
          TextView timeView = (TextView) listItemView.findViewById(R.id.time);
          // Format the time string (i.e. "4:30PM")
          String formattedTime = formatTime(dateObject);
          // Display the time of the current earthquake in that TextView
          timeView.setText(formattedTime);

          // Return the list item view that is now showing the appropriate data
          return listItemView;
  }</code></pre>
<p>The above code includes two helper methods, formatDate() and formatTime(), that we created to accept a Date object and return an appropriately formatted date string using SimpleDateFormat.</p>
<pre><code>  /**
   * Return the formatted date string (i.e. "Mar 3, 1984") from a Date object.
   */
  private String formatDate(Date dateObject) {
      SimpleDateFormat dateFormat = new SimpleDateFormat("LLL dd, yyyy");
      return dateFormat.format(dateObject);
  }

  /**
   * Return the formatted date string (i.e. "4:30 PM") from a Date object.
   */
  private String formatTime(Date dateObject) {
      SimpleDateFormat timeFormat = new SimpleDateFormat("h:mm a");
      return timeFormat.format(dateObject);
  }</code></pre>
<p>With all these changes in place, the app should look like the following screenshot when we run it on our device. Note that it takes many rounds of trial/error to make the formatting look precisely as we wanted. It didn’t take just one try to get all the code to run perfectly.</p>
<p><img src="media/unnamed-160871-0.gif" width="200"></p>
<p>Great job! The date and time of the earthquake are looking much more readable now!</p>
</div>

</div>
<div class="divider"></div>
          </div>

          <div class="col-12">
            <p class="text-right">
              <a href="21. Split location into 2 TextViews.html" class="btn btn-outline-primary mt-4" role="button">Next Concept</a>
            </p>
          </div>
        </div>
      </main>

      <footer class="footer">
        <div class="container">
          <div class="row">
            <div class="col-12">
              <p class="text-center">
                <a href="https://us-udacity.github.io/" target="_blank">【udacity2.0 】If you need more courses, please add wechat：udacity6</a>
              </p>
            </div>
          </div>
        </div>
      </footer>
    </div>
  </div>


  <script src="../assets/js/jquery-3.3.1.min.js"></script>
  <script src="../assets/js/plyr.polyfilled.min.js"></script>
  <script src="../assets/js/bootstrap.min.js"></script>
  <script src="../assets/js/jquery.mCustomScrollbar.concat.min.js"></script>
  <script src="../assets/js/katex.min.js"></script>
  <script>
    // Initialize Plyr video players
    const players = Array.from(document.querySelectorAll('video')).map(p => new Plyr(p));

    // render math equations
    let elMath = document.getElementsByClassName('mathquill');
    for (let i = 0, len = elMath.length; i < len; i += 1) {
      const el = elMath[i];

      katex.render(el.textContent, el, {
        throwOnError: false
      });
    }

    // this hack will make sure Bootstrap tabs work when using Handlebars
    if ($('#question-tabs').length && $('#user-answer-tabs').length) {
      $("#question-tabs a.nav-link").on('click', function () {
        $("#question-tab-contents .tab-pane").hide();
        $($(this).attr("href")).show();
      });
      $("#user-answer-tabs a.nav-link").on('click', function () {
        $("#user-answer-tab-contents .tab-pane").hide();
        $($(this).attr("href")).show();
      });
    } else {
      $("a.nav-link").on('click', function () {
        $(".tab-pane").hide();
        $($(this).attr("href")).show();
      });
    }

    // side bar events
    $(document).ready(function () {
      $("#sidebar").mCustomScrollbar({
        theme: "minimal"
      });

      $('#sidebarCollapse').on('click', function () {
        $('#sidebar, #content').toggleClass('active');
        $('.collapse.in').toggleClass('in');
        $('a[aria-expanded=true]').attr('aria-expanded', 'false');
      });

      // scroll to first video on page loading
      if ($('video').length) {
        $('html,body').animate({ scrollTop: $('div.plyr').prev().offset().top});
      }

      // auto play first video: this may not work with chrome/safari due to autoplay policy
      if (players && players.length > 0) {
        players[0].play();
      }

      // scroll sidebar to current concept
      const currentInSideBar = $( "ul.sidebar-list.components li a:contains('20. Quiz: Display date and time of earthquake')" )
      currentInSideBar.css( "text-decoration", "underline" );
      $("#sidebar").mCustomScrollbar('scrollTo', currentInSideBar);
    });
  </script>
</body>

</html>
