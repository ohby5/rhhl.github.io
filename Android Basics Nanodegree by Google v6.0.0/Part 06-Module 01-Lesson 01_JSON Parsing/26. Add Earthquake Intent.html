<!-- udacity2.0 -->
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Add Earthquake Intent</title>
  <link rel="stylesheet" href="../assets/css/bootstrap.min.css">
  <link rel="stylesheet" href="../assets/css/plyr.css">
  <link rel="stylesheet" href="../assets/css/katex.min.css">
  <link rel="stylesheet" href="../assets/css/jquery.mCustomScrollbar.min.css">
  <link rel="stylesheet" href="../assets/css/styles.css">
  <link rel="shortcut icon" type="image/png" href="../assets/img/udacimak.png" />
</head>

<body>
  <div class="wrapper">
    <nav id="sidebar">
  <div class="sidebar-header">
    <h3>JSON Parsing</h3>
  </div>

  <ul class="sidebar-list list-unstyled CTAs">
    <li>
      <a href="../index.html" class="article">Back to Home</a>
    </li>
  </ul>

  <ul class="sidebar-list list-unstyled components">
    <li class="">
      <a href="01. Earthquake at the Coffee Shop.html">01. Earthquake at the Coffee Shop</a>
    </li>
    <li class="">
      <a href="02. Where to Find Earthquake Data .html">02. Where to Find Earthquake Data? </a>
    </li>
    <li class="">
      <a href="03. Receiving Mocks from Our Designer.html">03. Receiving Mocks from Our Designer</a>
    </li>
    <li class="">
      <a href="04. Course Map.html">04. Course Map</a>
    </li>
    <li class="">
      <a href="05. Explore USGS Website As A User.html">05. Explore USGS Website As A User</a>
    </li>
    <li class="">
      <a href="06. Drive-Through Data.html">06. Drive-Through Data</a>
    </li>
    <li class="">
      <a href="07. Explore USGS Website As A Developer.html">07. Explore USGS Website As A Developer</a>
    </li>
    <li class="">
      <a href="08. Import Existing Project.html">08. Import Existing Project</a>
    </li>
    <li class="">
      <a href="09. Checking the build.gradle file.html">09. Checking the build.gradle file</a>
    </li>
    <li class="">
      <a href="10. Solution Code on GitHub.html">10. Solution Code on GitHub</a>
    </li>
    <li class="">
      <a href="11. Show more info on each earthquake.html">11. Show more info on each earthquake</a>
    </li>
    <li class="">
      <a href="12. Overview of JSON.html">12. Overview of JSON</a>
    </li>
    <li class="">
      <a href="13. JSON Components.html">13. JSON Components</a>
    </li>
    <li class="">
      <a href="14. Traverse Nodes in JSON Object Tree.html">14. Traverse Nodes in JSON Object Tree</a>
    </li>
    <li class="">
      <a href="15. Parsing JSON in Android.html">15. Parsing JSON in Android</a>
    </li>
    <li class="">
      <a href="16. Look at Earthquake Query Result.html">16. Look at Earthquake Query Result</a>
    </li>
    <li class="">
      <a href="17. Traversing Earthquake JSON Object Tree.html">17. Traversing Earthquake JSON Object Tree</a>
    </li>
    <li class="">
      <a href="18. Parse JSON response in Quake Report app.html">18. Parse JSON response in Quake Report app</a>
    </li>
    <li class="">
      <a href="19. Display date and time of earthquake.html">19. Display date and time of earthquake</a>
    </li>
    <li class="">
      <a href="20. Quiz Display date and time of earthquake.html">20. Quiz: Display date and time of earthquake</a>
    </li>
    <li class="">
      <a href="21. Split location into 2 TextViews.html">21. Split location into 2 TextViews</a>
    </li>
    <li class="">
      <a href="22. Magnitude as a Decimal Value.html">22. Magnitude as a Decimal Value</a>
    </li>
    <li class="">
      <a href="23. Switch Statement.html">23. Switch Statement</a>
    </li>
    <li class="">
      <a href="24. Circle Background for Magnitude.html">24. Circle Background for Magnitude</a>
    </li>
    <li class="">
      <a href="25. Visual Polish.html">25. Visual Polish</a>
    </li>
    <li class="">
      <a href="26. Add Earthquake Intent.html">26. Add Earthquake Intent</a>
    </li>
    <li class="">
      <a href="27. Reflection.html">27. Reflection</a>
    </li>
  </ul>

  <ul class="sidebar-list list-unstyled CTAs">
    <li>
      <a href="../index.html" class="article">Back to Home</a>
    </li>
  </ul>
</nav>

    <div id="content">
      <header class="container-fluild header">
        <div class="container">
          <div class="row">
            <div class="col-12">
              <div class="align-items-middle">
                <button type="button" id="sidebarCollapse" class="btn btn-toggle-sidebar">
                  <div></div>
                  <div></div>
                  <div></div>
                </button>

                <h1 style="display: inline-block">26. Add Earthquake Intent</h1>
              </div>
            </div>
          </div>
        </div>
      </header>

      <main class="container">
        <div class="row">
          <div class="col-12">
            <div class="ud-atom">
  <h3><p>Add Earthquake Intent</p></h3>
  <div>
  <div>
    <h4>Question:</h4>


    <p><p>Ok, there’s actually ONE more thing left to do for the list UI to be finished. And good news, you already know these concepts!</p>
<p>Implementing this feature will involve remembering what we learned in the last course about click listeners on items in a ListView. </p>
<h3 id="your-turn">Your Turn</h3>
<p>Set up Quake Report so that when users click on a particular list item, they are sent to the USGS web page to see additional details on that earthquake.</p>
<p><img src="media/unnamed-160985-0.gif" width="500"></p>
<p>As you discovered in an earlier quiz, the JSON response from the server contains a website URL for that earthquake. We need to extract that field and store it in our app.</p>
<p>Once we detect the user has clicked on a list item, we need to open the right web page. Since we don’t care which web browser app on the device opens the web page, we can create and send an implicit intent that contains the website URL. Feel free to search online on how to accomplish the different parts of this task.</p></p>
  </div>

  <h4>Start Quiz:</h4>
  <div>
  <div style="display: block;">
    <div style="position: relative;">
      <img src="img/8923630445.gif" style="width: 100%; max-height: 100%" alt="">
      
    <div style="
    position: absolute; top: 50.22519401330376%; left: 8.354114713216958%; width: 75.81047381546135%; height: 8.425720620842572%;
  ">
      
        <input type="text" style="width: 100%; height: 100%;" name="null" id="text1" aria-label="">
      
    </div>
  
    <div style="
    position: absolute; top: 77.88248337028824%; left: 9.226932668329177%; width: 76.05985037406484%; height: 9.090909090909092%;
  ">
      
        <input type="text" style="width: 100%; height: 100%;" name="null" id="text2" aria-label="">
      
    </div>
  
    </div>
  </div>
</div>


  <div>
    <details>
      <summary><strong>Solution:</strong></summary>
      <div>

        <p><h3 id="quiz-solution">Quiz Solution</h3>
<p>Here are the answers to the questions:</p>
<ol>
<li>What was the key in the JSON response to get the website URL for the earthquake? “Url”</li>
<li>What intent action did you set on the intent to open the web browser? Intent.ACTION_VIEW</li>
</ol>
<h3 id="extract-the-website-url">Extract the website URL</h3>
<p>The JSON response contains a website URL for each earthquake under the key “url”. We need to extract this value alongside the other earthquake data during parsing. Then we should pass in the url into the Earthquake object.</p>
<p>In QueryUtils extractEarthquake():</p>
<pre><code>  // Extract the value for the key called "url"
  String url = properties.getString("url");

  // Create a new {@link Earthquake} object with the magnitude, location, time,
  // and url from the JSON response.
  Earthquake earthquake = new Earthquake(magnitude, location, time, url);</code></pre>
<h3 id="store-the-website-url">Store the website URL</h3>
<p>The above change requires us to update the Earthquake class as well. We need to:</p>
<ul>
<li>modify the constructor to accept a String input parameter for the URL</li>
<li>add a private global variable to store the URL</li>
<li>provide a public getter method so that other classes can access that variable.</li>
</ul>
<p>In Earthquake.java:</p>
<pre><code>  /** Website URL of the earthquake */
  private String mUrl;

  …

  /**
  * Constructs a new {@link Earthquake} object.
  *
  * @param magnitude is the magnitude (size) of the earthquake
  * @param location is the location where the earthquake happened
  * @param timeInMilliseconds is the time in milliseconds (from the Epoch) when the
  *                           earthquake happened
  * @param url is the website URL to find more details about the earthquake
  */
  public Earthquake(double magnitude, String location, long timeInMilliseconds, String url) {
     mMagnitude = magnitude;
     mLocation = location;
     mTimeInMilliseconds = timeInMilliseconds;
     mUrl = url;
  }

  …

  /**
  * Returns the website URL to find more information about the earthquake.
  */
  public String getUrl() {
     return mUrl;
  }</code></pre>
<h3 id="handle-the-list-item-click">Handle the list item click</h3>
<p>Once the earthquake URL is properly stored in the Earthquake objects, we can access the URL when the list item is clicked. From the last course, we learned how to detect and respond when a user taps on a list item. We need to declare an <a href="https://developer.android.com/reference/android/widget/AdapterView.OnItemClickListener.html?utm_source=udacity&utm_medium=course&utm_campaign=android_basics" target="_blank">OnItemClickListener</a> on the ListView. OnItemClickListener is an interface, which contains a single method onItemClick(). We declare an anonymous class that implements this interface, and provides customized logic for what should happen in the onItemClick() method. Remember that the onItemClick() method is a callback triggered by the Android system when the user clicks on a list item. </p>
<p>In EarthquakeActivity onCreate():</p>
<pre><code>  ...

  // Create a new adapter that takes the list of earthquakes as input
  final EarthquakeAdapter adapter = new EarthquakeAdapter(this, earthquakes);

  // Set the adapter on the {@link ListView}
  // so the list can be populated in the user interface
  earthquakeListView.setAdapter(adapter);

  earthquakeListView.setOnItemClickListener(new AdapterView.OnItemClickListener() {
     @Override
     public void onItemClick(AdapterView&lt;?&gt; adapterView, View view, int position, long l) {
         // Find the current earthquake that was clicked on
         Earthquake currentEarthquake = adapter.getItem(position);

         // Convert the String URL into a URI object (to pass into the Intent constructor)
         Uri earthquakeUri = Uri.parse(currentEarthquake.getUrl());

         // Create a new intent to view the earthquake URI
         Intent websiteIntent = new Intent(Intent.ACTION_VIEW, earthquakeUri);

         // Send the intent to launch a new activity
         startActivity(websiteIntent);
     }
  });</code></pre>
<p>We override the onItemClick() method, so that when a list item is clicked, we find the corresponding Earthquake object from the adapter. (Note that we also had to add the “final” modifier on the EarthquakeAdapter local variable, so that we could access the adapter variable within the OnItemClickListener.) </p>
<pre><code>  Earthquake currentEarthquake = adapter.getItem(position);</code></pre>
<p>Then we can get the URL from the current Earthquake object. But then how do we open the website? What if the user has multiple web browsers installed? Which app should open up the earthquake website? It would be better to use the defaults the user has already chosen, or give them the option. We can do this by creating an implicit intent.</p>
<p>Instead of deciding exactly what activity we want to launch with an intent, we can instead specify what action we want to perform, without giving any option on what activity should actually handle that action. In this case, we'll create an intent with the action of viewing something. What do we want to view? Well this Intent <a href="https://developer.android.com/reference/android/content/Intent.html?utm_source=udacity&utm_medium=course&utm_campaign=android_basics#Intent(java.lang.String,%20android.net.Uri)" target="_blank">constructor</a> also accepts a URI for the data resource we want to view, and Android will sort out the best app to handle this sort of content. For instance, if the URI represented a location, Android would open up a mapping app. In this case, the resource is an HTTP URL, so Android will usually open up a browser.</p>
<p>The Intent constructor (that we want to use) requires a Uri object, so we need to convert our URL (in the form of a String) into a URI. We know that our earthquake URL is a more specific form of a URI, so we can use the <a href="https://developer.android.com/reference/android/net/Uri.html?utm_source=udacity&utm_medium=course&utm_campaign=android_basics#parse(java.lang.String)" target="_blank">Uri.parse method</a> (see <a href="http://stackoverflow.com/questions/3487389/convert-string-to-uri" target="_blank">this StackOverflow post</a>).</p>
<pre><code>  Uri earthquakeUri = Uri.parse(currentEarthquake.getUrl());</code></pre>
<p>Once we have the website URL in a Uri object, we can create a new intent.</p>
<pre><code>  Intent websiteIntent = new Intent(Intent.ACTION_VIEW, earthquakeUri);</code></pre>
<p>Lastly, we start a new activity with that intent, so that a web browser app on the device will handle the intent and display the website for that earthquake. </p>
<pre><code>  startActivity(websiteIntent);</code></pre></p>
      </div>
    </details>
  </div>
</div>


</div>
<div class="divider"></div>
          </div>

          <div class="col-12">
            <p class="text-right">
              <a href="27. Reflection.html" class="btn btn-outline-primary mt-4" role="button">Next Concept</a>
            </p>
          </div>
        </div>
      </main>

      <footer class="footer">
        <div class="container">
          <div class="row">
            <div class="col-12">
              <p class="text-center">
                <a href="https://us-udacity.github.io/" target="_blank">【udacity2.0 】If you need more courses, please add wechat：udacity6</a>
              </p>
            </div>
          </div>
        </div>
      </footer>
    </div>
  </div>


  <script src="../assets/js/jquery-3.3.1.min.js"></script>
  <script src="../assets/js/plyr.polyfilled.min.js"></script>
  <script src="../assets/js/bootstrap.min.js"></script>
  <script src="../assets/js/jquery.mCustomScrollbar.concat.min.js"></script>
  <script src="../assets/js/katex.min.js"></script>
  <script>
    // Initialize Plyr video players
    const players = Array.from(document.querySelectorAll('video')).map(p => new Plyr(p));

    // render math equations
    let elMath = document.getElementsByClassName('mathquill');
    for (let i = 0, len = elMath.length; i < len; i += 1) {
      const el = elMath[i];

      katex.render(el.textContent, el, {
        throwOnError: false
      });
    }

    // this hack will make sure Bootstrap tabs work when using Handlebars
    if ($('#question-tabs').length && $('#user-answer-tabs').length) {
      $("#question-tabs a.nav-link").on('click', function () {
        $("#question-tab-contents .tab-pane").hide();
        $($(this).attr("href")).show();
      });
      $("#user-answer-tabs a.nav-link").on('click', function () {
        $("#user-answer-tab-contents .tab-pane").hide();
        $($(this).attr("href")).show();
      });
    } else {
      $("a.nav-link").on('click', function () {
        $(".tab-pane").hide();
        $($(this).attr("href")).show();
      });
    }

    // side bar events
    $(document).ready(function () {
      $("#sidebar").mCustomScrollbar({
        theme: "minimal"
      });

      $('#sidebarCollapse').on('click', function () {
        $('#sidebar, #content').toggleClass('active');
        $('.collapse.in').toggleClass('in');
        $('a[aria-expanded=true]').attr('aria-expanded', 'false');
      });

      // scroll to first video on page loading
      if ($('video').length) {
        $('html,body').animate({ scrollTop: $('div.plyr').prev().offset().top});
      }

      // auto play first video: this may not work with chrome/safari due to autoplay policy
      if (players && players.length > 0) {
        players[0].play();
      }

      // scroll sidebar to current concept
      const currentInSideBar = $( "ul.sidebar-list.components li a:contains('26. Add Earthquake Intent')" )
      currentInSideBar.css( "text-decoration", "underline" );
      $("#sidebar").mCustomScrollbar('scrollTo', currentInSideBar);
    });
  </script>
</body>

</html>
