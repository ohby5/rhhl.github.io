WEBVTT
Kind: captions
Language: zh-CN

00:00:00.380 --> 00:00:03.750
设置网络请求的必要
先决条件之一为你的

00:00:03.750 --> 00:00:07.380
应用必须创建了可通过其
发送请求的网络连接

00:00:07.380 --> 00:00:09.200
现在 在 Android 上创建应用时

00:00:09.200 --> 00:00:12.500
默认情况下
不具有访问 Internet 的功能

00:00:12.500 --> 00:00:15.050
我将通过使用为本课程创建的
Soonami 应用来演示我

00:00:15.050 --> 00:00:16.360
所表达的意思

00:00:16.360 --> 00:00:19.090
现在 假设此应用在
执行 HTTP 请求

00:00:19.090 --> 00:00:21.290
即检索地震信息

00:00:21.290 --> 00:00:23.280
然而应用发生崩溃

00:00:23.280 --> 00:00:26.470
如果我们检查 Android 日志
会发现安全性例外

00:00:26.470 --> 00:00:28.400
也就是说 缺少
Internet 权限

00:00:28.400 --> 00:00:31.990
Soonami 应用不曾请求获得
访问 Internet 的权限 因此

00:00:31.990 --> 00:00:35.210
Android 操作系统拒绝了
Soonami 尝试发出 HTTP 请求的

00:00:35.210 --> 00:00:36.310
意图

00:00:36.310 --> 00:00:38.360
因而产生了应用崩溃情况

00:00:38.360 --> 00:00:41.340
你的应用需要请求可在
用户设备上执行受保护

00:00:41.340 --> 00:00:42.780
操作的权限

00:00:42.780 --> 00:00:46.070
受保护操作包括
创建网络连接

00:00:46.070 --> 00:00:52.200
访问照相机、设置 SMS
消息、拨打电话

00:00:52.200 --> 00:00:56.430
通过麦克风录音
甚至包括确定用户位置

00:00:56.430 --> 00:01:00.350
还需要具有当设备状态发生
某些变化时获得通知的权限

00:01:00.350 --> 00:01:02.770
例如网络连接状态

00:01:02.770 --> 00:01:05.670
有关你的应用能够请求的
可能权限的完整列表

00:01:05.670 --> 00:01:07.570
可以查看
介绍文档

00:01:07.570 --> 00:01:10.510
你可能觉得奇怪 如果我
只是向照相机应用

00:01:10.510 --> 00:01:13.150
发送拍照
的意图 或者发送

00:01:13.150 --> 00:01:16.910
传送 SMS 消息或拨打电话的意图
那么 为什么需要权限？

00:01:16.910 --> 00:01:20.040
权利或重要性是你可以
请求另一个应用来代表

00:01:20.040 --> 00:01:24.050
你执行操作而无需
自己声明权限

00:01:24.050 --> 00:01:27.590
然而 例如 如果你正在构建一个自定义
照相机应用 则你必须

00:01:27.590 --> 00:01:30.109
请求照相机的权限以
直接访问硬件

00:01:31.210 --> 00:01:33.730
对于你想要请求的
每个权限 你都要

00:01:33.730 --> 00:01:38.240
向应用的 Android 清单文件中
添加使用权限 (uses-permission) 元素

00:01:38.240 --> 00:01:41.780
例如 如果你创建了一个消息传送
应用且希望用户能够在你的

00:01:41.780 --> 00:01:45.335
应用内直接发送 SMS 消息
则你会在清单中声明

00:01:45.335 --> 00:01:48.655
该应用需要发送 SMS (SEND_SMS)
权限字符串

00:01:48.655 --> 00:01:51.195
在你的清单中 必须存在
针对应用程序

00:01:51.195 --> 00:01:53.245
需要的每个权限的
用户权限行

00:01:53.245 --> 00:01:56.132
应用程序权限具有
不同的保护级别

00:01:56.132 --> 00:02:01.482
你需要了解的两个最重要的
级别是正常和危险

00:02:01.482 --> 00:02:04.772
正常权限不会对用户隐私
或其他应用的

00:02:04.772 --> 00:02:06.582
操作构成威胁

00:02:06.582 --> 00:02:09.211
因此 系统将自动
批准这些权限

00:02:09.211 --> 00:02:13.032
危险权限会访问用户的
个人身份信息或

00:02:13.032 --> 00:02:14.257
私人信息

00:02:14.257 --> 00:02:18.072
并且会访问可能影响其他
应用的操作方式的功能

00:02:18.072 --> 00:02:22.180
其中包括 使用照相机、访问
联系人或通话记录 或者

00:02:22.180 --> 00:02:24.150
通过麦克风录音

00:02:24.150 --> 00:02:26.540
运行这些权限前必须
先进行请求

00:02:26.540 --> 00:02:29.680
用户必须通过
系统对话明确授权

00:02:29.680 --> 00:02:31.800
对话应是这个样子

00:02:31.800 --> 00:02:35.040
该应用正在请求访问
用户联系人的权限

00:02:35.040 --> 00:02:38.540
用户接受权限后
该对话将不再弹出

00:02:38.540 --> 00:02:41.390
注意 如果用户拒绝了权限请求
应用应仍然继续

00:02:41.390 --> 00:02:43.690
如常运行 只是
不具有该功能

00:02:43.690 --> 00:02:47.280
请注意 仅在 Android 6.0 Marshmallow 版本中
介绍了运行时

00:02:47.280 --> 00:02:51.310
权限模型并且在之后的版本中
将其应用至任意设备

00:02:51.310 --> 00:02:54.646
例如 在 Instagram 应用中
尝试发布库中的照片时

00:02:54.646 --> 00:02:58.261
系统将直接提示用户是否允许
访问设备上的大量

00:02:58.261 --> 00:03:00.290
照片和媒体文件

00:03:00.290 --> 00:03:03.750
然而 在运行 Android 5.1 或
更新版本的 Android 设备上

00:03:03.750 --> 00:03:07.610
系统将提示用户接受
安装应用时弹出的所有内容

00:03:07.610 --> 00:03:11.100
如果你使用的是旧版 Android 设备
则你之前可能看到过此画面

00:03:11.100 --> 00:03:13.150
现在 旧型号已消失殆尽

00:03:13.150 --> 00:03:15.685
用户必须接受所有
请求的权限 否则

00:03:15.685 --> 00:03:17.365
将无法安装应用

00:03:17.365 --> 00:03:18.655
具有运行时权限时

00:03:18.655 --> 00:03:22.145
用户可以有选择地
授予应用权限

00:03:22.145 --> 00:03:24.595
开发人员必须能够
对撤销权限做出反应

00:03:25.785 --> 00:03:29.225
这里有一篇关于涉及权限
的最佳实践的实用文章

00:03:29.225 --> 00:03:32.950
总而言之 你应该
在满足应用需要的同时

00:03:32.950 --> 00:03:34.720
尽可能少地定义权限

00:03:34.720 --> 00:03:37.320
例如
不如考虑使用意图

00:03:37.320 --> 00:03:38.480
其次 请求大量非必要

00:03:38.480 --> 00:03:42.070
权限的应用可能
对用户表现出怀疑 进而

00:03:42.070 --> 00:03:44.510
导致无法
如常安装

00:03:44.510 --> 00:03:46.160
因此 不要使用户面对过多权限

00:03:46.160 --> 00:03:49.600
在本课程中 我们不会使用
危险权限 但是如果你使用了

00:03:49.600 --> 00:03:53.400
请确保具有充分的理由来解释
需要对用户设置此权限的原因

00:03:53.400 --> 00:03:56.130
在本次测验中
请回答以下问题

00:03:56.130 --> 00:03:58.110
在用户日历中读取和
写入事件时 是否需要

00:03:58.110 --> 00:04:00.080
声明权限?

00:04:00.080 --> 00:04:03.030
在设备上播放音频
或视频时呢?

00:04:03.030 --> 00:04:06.280
或者访问用户的
当前位置 或者

00:04:06.280 --> 00:04:09.760
最后一个 在设备上
显示通知时?

00:04:09.760 --> 00:04:12.260
你可以查看测验下方的文档
链接来帮助你

