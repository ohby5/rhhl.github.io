WEBVTT
Kind: captions
Language: zh-CN

00:00:00.340 --> 00:00:03.570
回到 Tsunami 应用代码中 我们来观察如何利用

00:00:03.570 --> 00:00:06.060
StringBuilder 来构建 JSON 字符串响应

00:00:06.060 --> 00:00:07.959
首先来看 readFromStream 方法

00:00:07.959 --> 00:00:10.701
在 readFromStream 方法中 具有 inputStream

00:00:10.701 --> 00:00:14.210
我们想要返回一个含有输入流 内容的字符串

00:00:14.210 --> 00:00:17.560
因此要新建一个 StringBuilder 向其添加

00:00:17.560 --> 00:00:20.440
BufferedReader 中所有可用的 各行文本

00:00:20.440 --> 00:00:22.020
首先 设置 builder

00:00:22.020 --> 00:00:25.520
和 reader 然后向 BufferedReader 请求一行文本

00:00:25.520 --> 00:00:29.030
在文本不为 null 时将该行 添加到 StringBuilder 中

00:00:29.030 --> 00:00:29.970
然后继续读取另一行

00:00:29.970 --> 00:00:33.115
最后直到 BufferedReader 中没有文本 使用 toString

00:00:33.115 --> 00:00:36.405
方法从 StringBuilder 中获取 并返回最终输出

00:00:36.405 --> 00:00:39.245
由此可见 相比于每当出现需添加到 响应文本的新增内容

00:00:39.245 --> 00:00:42.715
便不断新建字符串对象 的方式

00:00:42.715 --> 00:00:46.035
使用 StringBuilder 来逐步构建响应 字符串的效率更高

